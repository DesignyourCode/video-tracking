/*!
 * Tracking for Youtube and HTML5 Videos
 * @version 1.0.0
 * @author DesignyourCode
 * @license The MIT License (MIT)
 */
!function(e){e.fn.trackVideo=function(t){return"undefined"!=typeof ga?(this.each(function(){function i(e){return new YT.Player("player-"+e.videoId,{height:e.height,width:e.width,videoId:e.videoId,playerVars:f.playerVars,events:{onStateChange:a}})}function a(t){for(var i=0;i<y.length;i++){var a=y[i].id;g=e("#"+a).attr("data-title")?e("#"+a).data("title"):void 0!==y[i].videoTitle?y[i].videoTitle:"No video title set"}t.data===-1?m="Unstarted":0===t.data?m="Ended":1===t.data?m="Playing":2===t.data?(clearTimeout(p),p=setTimeout(function(){o(t,t.target.getCurrentTime())},2e3)):3===t.data?m="Buffering":5===t.data&&(m="Video cued"),2!==t.data&&s(t.data,t.target.getCurrentTime())}function s(e,t){ga("send","event","Videos",m,g,parseInt(t)),f.kissmetrics===!0&&_kmq.push(["record","Videos",{"video-title":g,"video-state":m,"video-time":parseInt(t)}])}function o(e,t){2===e.data&&(m="Paused",s(e.data,t))}function d(e){var t=e/4;sessionStorage.setItem("one",t),sessionStorage.setItem("two",2*t),sessionStorage.setItem("three",3*t)}function n(e){var t=e.currentTime;t>=sessionStorage.getItem("one")&&t<sessionStorage.getItem("two")?(ga("send","event",w,"25% video played",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"video asset 25% video played":T}]),sessionStorage.setItem("one",null)):t>=sessionStorage.getItem("two")&&t<sessionStorage.getItem("three")?(ga("send","event",w,"50% video played",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"video asset 50% video played":T}]),sessionStorage.setItem("two",null)):t>=sessionStorage.getItem("three")&&(ga("send","event",w,"75% video played",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"video asset 75% video played":T}]),sessionStorage.setItem("three",null))}function r(){ga("send","event",w,"100% video played",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"100% video played":T}])}function u(){ga("send","event",w,"video played",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"video played":T}]),d(this.duration)}function c(e){var t=e.currentTime,i=e.duration;ga("send","event",w,"video paused",T),f.kissmetrics===!0&&_kmq.push(["record",w,{"video paused at":t+"/"+i}])}var l=e(this).data("track-video");if("youtube"===l){var v=document.createElement("script");v.src="https://www.youtube.com/iframe_api";var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(v,h);var g,m,p,f=e.extend({playerVars:{rel:0,showinfo:0},kissmetrics:!1},t),y=[],k=e(this).data("height")?e(this).data("height"):480,I=(e(this).data("width")?e(this).data("width"):853,e(this).attr("id").replace("player-",""));y.push({id:e(this).attr("id"),height:k,width:e(this).data("width"),videoId:I,videoTitle:g}),window.onYouTubeIframeAPIReady=function(){if("undefined"!=typeof y)for(var e=0;e<y.length;e++){i(y[e])}}}else if("html5"===l){var w,f=e.extend({kissmetrics:!1},t),S=e(this),T=S.data("title");w=void 0===S.data("gacategory")?"video":S.data("gacategory"),S.bind("ended",r),S.bind("timeupdate",function(){n(this)}),S.bind("play",u),S.bind("pause",function(){c(this)})}else console.warn("It looks like your video type isn't correct. Options include: html5 | youtube")}),this):void console.warn("Google Analytics is not installed")}}(jQuery);