/*!
 * Tracking for Youtube and HTML5 Videos
 * @version 1.0.0
 * @author DesignyourCode
 * @license The MIT License (MIT)
 */
!function(e){e.fn.trackVideo=function(t){if("undefined"==typeof ga)console.warn("Google Analytics is not installed");else{var i=document.createElement("script");i.src="https://www.youtube.com/iframe_api";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(i,a),this.each(function(){var i=e(this).data("track-video");if("youtube"===i){var a,s,o,d=[];e(this).each(function(){function i(e){return new YT.Player("player-"+e.videoId,{height:e.height,width:e.width,videoId:e.videoId,playerVars:c.playerVars,events:{onStateChange:n}})}function n(e){e.data===-1?o="Unstarted":0===e.data?o="Ended":1===e.data?o="Playing":2===e.data?(clearTimeout(s),s=setTimeout(function(){u(e,e.target.getCurrentTime())},2e3)):3===e.data?o="Buffering":5===e.data&&(o="Video cued"),2!==e.data&&r(e.data,e.target.getCurrentTime())}function r(e,t){ga("send","event","Videos",o,a,parseInt(t)),c.kissmetrics===!0&&_kmq.push(["record","Videos",{"video-title":a,"video-state":o,"video-time":parseInt(t)}])}function u(e,t){2===e.data&&(o="Paused",r(e.data,t))}var c=e.extend({playerVars:{},kissmetrics:!1},t);e('[id^="player-"]').each(function(){var t=e(this).data("height")?e(this).data("height"):480,i=e(this).data("width")?e(this).data("width"):853,s=e(this).attr("id").replace("player-",""),o=e(this).attr("id");a=e(this).attr("data-title")?e(this).data("title"):"Youtube Video: "+s,d.push({id:o,height:t,width:i,videoId:s,videoTitle:a})}),window.onYouTubeIframeAPIReady=function(){if("undefined"!=typeof d)for(var e=0;e<d.length;e++){i(d[e])}}})}else"html5"===i?e(this).each(function(){function i(e){var t=e/4;sessionStorage.setItem("one",t),sessionStorage.setItem("two",2*t),sessionStorage.setItem("three",3*t)}function a(e){var t=e.currentTime;t>=sessionStorage.getItem("one")&&t<sessionStorage.getItem("two")?(ga("send","event",n,"25% video played",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"video asset 25% video played":c}]),sessionStorage.setItem("one",null)):t>=sessionStorage.getItem("two")&&t<sessionStorage.getItem("three")?(ga("send","event",n,"50% video played",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"video asset 50% video played":c}]),sessionStorage.setItem("two",null)):t>=sessionStorage.getItem("three")&&(ga("send","event",n,"75% video played",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"video asset 75% video played":c}]),sessionStorage.setItem("three",null))}function s(){ga("send","event",n,"100% video played",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"100% video played":c}])}function o(){ga("send","event",n,"video played",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"video played":c}]),i(this.duration)}function d(e){var t=e.currentTime,i=e.duration;ga("send","event",n,"video paused",c),r.kissmetrics===!0&&_kmq.push(["record",n,{"video paused at":t+"/"+i}])}var n,r=e.extend({kissmetrics:!1},t),u=e(this),c=u.data("title");n=void 0===u.data("gacategory")?"video":u.data("gacategory"),u.bind("ended",s),u.bind("timeupdate",function(){a(this)}),u.bind("play",o),u.bind("pause",function(){d(this)})}):console.warn("It looks like your video type isn't correct. Options include: html5 | youtube")})}}}(jQuery);